<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>OpenToAll 2015 ~ BACH: Crypto 150</title>
    <meta name="description" content="  Well, not quite…Author: Eriner">
  
    
    <meta name="keywords" content="OpenToAll, Crypto, CTF" />
    

    <meta name="HandheldFriendly" content="True">
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
	
    <!-- Open Graph data -->

	<meta property="og:title" content="OpenToAll 2015 ~ BACH: Crypto 150" />
	<meta property="og:type" content="article" />




<meta property="og:image" content="/images/cover.png" />


<meta property="og:site_name" content="Black Magic Exploitation" />
<meta property="og:description" content="  Well, not quite…Author: Eriner" />


<meta property="og:url" content="/blog/ctf/crypto/all/Bach" />


    
	<meta property="article:author" content="http://jwillmer.de/about" />
	<link rel="author" href="http://jwillmer.de/about" />



<meta property="article:published_time" content="2015-03-29T00:59:33-05:00" />



<meta property="article:tag" content="OpenToAll" />

<meta property="article:tag" content="Crypto" />

<meta property="article:tag" content="CTF" />

<!-- End: Open Graph data -->	
	<!-- Twitter data -->
    

<meta name="twitter:card" content="summary">


<meta name="twitter:site" content="@VivieTurtle">



<meta name="twitter:title" content="OpenToAll 2015 ~ BACH: Crypto 150">




<meta name="twitter:url" content="/blog/ctf/crypto/all/Bach">


<meta name="twitter:description" content="  Well, not quite…Author: Eriner">

<meta name="twitter:image:src" content="/images/cover.png">
<!-- End: Twitter data -->	

    <link href='https://fonts.googleapis.com/css?family=Mrs+Saint+Delafield|Merriweather:300italic,700,300,700italic|Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/screen.css">
    <link rel="stylesheet" href="/css/prism.css">
    <link rel="alternate" type="application/rss+xml" title="Black Magic Exploitation" href="/feed.xml">

    <link rel="icon" href="/images/vivi.png" sizes="16x16" type="image/png">
    <link rel="icon" href="/images/vivi.png" sizes="32x32" type="image/png">
    <link rel="icon" href="/images/vivi.png" sizes="48x48" type="image/png">
    <link rel="icon" href="/images/vivi.png" sizes="62x62" type="image/png">
</head>

<body class="home-template">
    <div class="site-wrapper">
        

<header class="main-header detail-page image-bg  has-cover" style=" background-size: cover; background-image: url(/images/cover.png)" >
    <h1 class="page-title"><a href="/" title="Black Magic Exploitation">Black Magic Exploitation</a></h1>
    <h2 class="page-description">CTF's, Exploits, and Black Magic</h2>
    <div class="nav">
        <ul>
            <li><a class="page-link" href="/" title="Home">Home</a></li>

            
            

            

            
            

            

            
            

            

            
            

            

            
            

            

            
            

            

            
            

            

            
            

            

            
            

            

            
            <li><a class="page-link" href="/Programming/" title="Programming">Programming</a></li>
            
            

            

            
            <li><a class="page-link" href="/about/" title="About">About</a></li>
            
            
        </ul>
    </div>
</header>
        <main class="content" role="main">
    <article class="post single-post" itemscope itemtype="http://schema.org/BlogPosting">

        <header class="post-header short-diver">
            <h1 class="post-title" itemprop="name headline">OpenToAll 2015 ~ BACH: Crypto 150</h1>
            <section class="post-meta">
                <time datetime="2015-03-29T00:59:33-05:00" itemprop="datePublished">Mar 29, 2015</time> 
                on
                
                <span>OpenToAll</span>
                
                <span>Crypto</span>
                
                <span>CTF</span>
                
            </section>
        </header>

        <section class="post-content short-diver" itemprop="articleBody">
            <blockquote>
  <p>Well, not quite…
Author: Eriner</p>
</blockquote>

<p>This challenge was quite a simple Cryptography challenge given that it requires zero knowledge of ciphers or anything else related to cryptopgrahy. We were given a link to download the file : 8aec78b8dca5541b69d07404f1a6be68.tar.bz2 which contained a single image.</p>

<p><a href="http://localhost:4000/images/open2all/f4923a0aa2a3cc07026e38f41b3cd673.png"><img src="http://localhost:4000/images/open2all/f4923a0aa2a3cc07026e38f41b3cd673.png" alt="Bach" /></a></p>

<p>Given my piano background, I began to read the notes for what they were ignoring all the naturals thinking they had nothing to do with the code.</p>

<p>Sight reading:</p>

<blockquote>
  <p>FA#E _FE#AG_B#E _ EDB#G#EDEF#GED#EAE#F#AEFEDBB#ECE</p>
</blockquote>

<p>Given that that there are four words my guess would be that it would contain some kind of sentence. If you look at the second word, F-E#-A-G, it almost makes out to the word “FLAG”. I began looking for a pattern and I noticed the “E#” would be considered an “L” which is one full cycle of 7 notes after “E”. In other words, given that A-G were given, than “A” can also be “H”, and “B” can be “I” and so forth. I looked further into this and tried deciphering the rest of the words.My possible guess for this was</p>

<blockquote>
  <p>The Flag is …. EDINEDEMGEKEALMAEFEDBIECE</p>
</blockquote>

<p>I then wrote a script called bruteforce.py to bruteforce the last word because I had thought it would take too long to guess every possible combination if I tried guessing that “E” can be “L”, “S” or “Z” and “A” can be “H “O” and “V”. After about 5 minutes, I canceled the script because I realized it would take too long. I looked back at the image and was curious about why the naturals were there.I then saw the pattern!</p>

<table>
  <thead>
    <tr>
      <th>Normal</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Sharps</strong></td>
      <td>H</td>
      <td>I</td>
      <td>J</td>
      <td>K</td>
      <td>L</td>
      <td>M</td>
      <td>N</td>
    </tr>
    <tr>
      <td><strong>Naturals</strong></td>
      <td>O</td>
      <td>P</td>
      <td>Q</td>
      <td>R</td>
      <td>S</td>
      <td>T</td>
      <td>U</td>
    </tr>
    <tr>
      <td><strong>Flats</strong></td>
      <td>V</td>
      <td>W</td>
      <td>X</td>
      <td>Y</td>
      <td>Z</td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>Deciphering the image, the sentence says, the flag is erinsersmusicalmasterpiece. I inserted “Flag{erinsersmusicalmasterpiece}” to score my club another 150 points in the CTF.</p>

<p><a href="http://localhost:4000/assets/open2all/bruteforce.py">Bruteforce.py</a></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="c">#at first tried printing every iteration</span>
<span class="n">flag_encrypted</span> <span class="o">=</span> <span class="s">'EDINEDEMGEKEALMAEFEDBIECE'</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="s">'A'</span><span class="p">,</span><span class="s">'O'</span><span class="p">,</span><span class="s">'V'</span><span class="p">]</span>
<span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="s">'B'</span><span class="p">,</span><span class="s">'P'</span><span class="p">,</span><span class="s">'W'</span><span class="p">]</span>
<span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="s">'C'</span><span class="p">,</span><span class="s">'Q'</span><span class="p">,</span><span class="s">'X'</span><span class="p">]</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="s">'D'</span><span class="p">,</span><span class="s">'R'</span><span class="p">,</span><span class="s">'T'</span><span class="p">]</span>
<span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="s">'E'</span><span class="p">,</span><span class="s">'S'</span><span class="p">,</span><span class="s">'Z'</span><span class="p">]</span>
<span class="n">F</span> <span class="o">=</span> <span class="p">[</span><span class="s">'F'</span><span class="p">,</span><span class="s">'T'</span><span class="p">,</span><span class="s">'T'</span><span class="p">]</span>
<span class="n">G</span> <span class="o">=</span> <span class="p">[</span><span class="s">'N'</span><span class="p">,</span><span class="s">'U'</span><span class="p">,</span><span class="s">'U'</span><span class="p">]</span>
<span class="n">permutations</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">getLetter</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">letter</span> <span class="o">==</span> <span class="s">'A'</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">A</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">letter</span> <span class="o">==</span> <span class="s">'B'</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">B</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">letter</span> <span class="o">==</span> <span class="s">'C'</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">C</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">letter</span> <span class="o">==</span> <span class="s">'D'</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">D</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">letter</span> <span class="o">==</span> <span class="s">'E'</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">E</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">letter</span> <span class="o">==</span> <span class="s">'F'</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">F</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">letter</span> <span class="o">==</span> <span class="s">'G'</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">G</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
	<span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">letter</span>

<span class="k">def</span> <span class="nf">done</span><span class="p">():</span>
	<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">permutations</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">False</span>
	<span class="k">return</span> <span class="bp">True</span>
<span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">permutations</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
		<span class="n">permutations</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="nb">next</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span> <span class="n">permutations</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">permutations</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">():</span>
	<span class="n">stringbuilder</span> <span class="o">=</span> <span class="s">''</span>
	<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">flag_encrypted</span><span class="p">)):</span>
		<span class="n">stringbuilder</span> <span class="o">=</span> <span class="n">stringbuilder</span>  <span class="o">+</span> <span class="n">getLetter</span><span class="p">(</span><span class="n">flag_encrypted</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">permutations</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
	<span class="k">print</span> <span class="s">'The Flag is '</span> <span class="o">+</span> <span class="n">stringbuilder</span>
	<span class="nb">next</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span></code></pre></figure>


        </section>

        <footer class="post-footer"> 
            <div itemprop="author" itemscope itemtype="http://schema.org/Person">

    

    
    

    

</div>
        </footer>

    </article>
</main>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>
    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script src="/js/jquery-1.12.0.min.js"></script>
<script src="/js/jquery.fitvids.js"></script>
<script src="/js/prism.js"></script>
<script src="/js/photoswipe.js"></script>
<script src="/js/photoswipe-ui-default.js"></script>
<script src="/js/post.js"></script>        
        <footer class="site-footer">
    <button class="go-to-top"></button>
    <p class="copyright"><a href="" title="Black Magic Exploitation">Black Magic Exploitation</a> &copy; 2018 | <a href="/feed.xml" title="RSS Feed">RSS Feed</a></p>
    <p class="poweredby">powered by <a href="https://jekyllrb.com/" title="Jekyll">Jekyll</a> with the <a href="https://github.com/jwillmer/jekyllDecent" title="jekyllDecent Theme">jekyllDecent</a> theme</p>
</footer>
    </div>
</body>

<script src="/js/global.js"></script>
</html>
